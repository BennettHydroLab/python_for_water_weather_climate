

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Getting started with matplotlib &#8212; Python for water, weather, and climate science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'course_content/module_2_numpy_and_matplotlib/2_intro_to_matplotlib';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Introduction to pandas" href="../module_3_pandas_and_data_handling/1_intro_to_pandas.html" />
    <link rel="prev" title="Introduction to numpy" href="1_intro_to_numpy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    <p class="title logo__title">Python for water, weather, and climate science</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Python for research in Water, Weather, and Climate
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 1 - Introduction to python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../module_1_intro_to_python/1_python_introduction.html">Introduction to python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_1_intro_to_python/2_python_stuff_you_should_know.html">Intermediate python - Or, stuff you should know</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_1_intro_to_python/exercises.html">Exercises for Module 1: Intro to Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 2 - Introduction to scientific python</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_intro_to_numpy.html">Introduction to numpy</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Getting started with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 3 - Working with real data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../module_3_pandas_and_data_handling/1_intro_to_pandas.html">Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_3_pandas_and_data_handling/2_apis_for_data_handling.html">Some lessons on working with real world data: APIs and data wrangling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 6 - Working with real climate data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../module_6_xarray_and_big_data/1_intro_to_xarray.html">Intro to <code class="docutils literal notranslate"><span class="pre">xarray</span></code></a></li>

<li class="toctree-l1"><a class="reference internal" href="../module_6_xarray_and_big_data/xarray_exercises_pt2.html"><code class="docutils literal notranslate"><span class="pre">xarray</span></code> exercises pt 2: ENSO Analysis</a></li>





</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/course_content/module_2_numpy_and_matplotlib/2_intro_to_matplotlib.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Getting started with matplotlib</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="getting-started-with-matplotlib">
<h1>Getting started with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code><a class="headerlink" href="#getting-started-with-matplotlib" title="Permalink to this heading">#</a></h1>
<p>Matplotlib is the most used plotting package
in python. It was designed to mimic the plotting
syntax and functionality from Matlab, hence
the name matplotlib.</p>
<p>Just like when we imported numpy “as np”
it is standard to have two separate imports
with simplified aliases</p>
<p>The base <code class="docutils literal notranslate"><span class="pre">mpl</span></code> import is used for high level
settings like setting a default figure or font
size. The import of <code class="docutils literal notranslate"><span class="pre">plt</span></code> provides the main
interface to the actual plotting functions.</p>
<p>To begin, we define the same air pressure
function as well as import numpy. Numpy and
matplotlib have been designed to work very
well together</p>
<p>Just like with numpy, matplotlib is a very
large and general purpose library so we won’t
be able to cover everything.</p>
<p>The introductory tutorials can be  found here:
<a class="reference external" href="https://matplotlib.org/stable/tutorials/introductory/index.html#">https://matplotlib.org/stable/tutorials/introductory/index.html#</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">air_pressure_at_height</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">273</span><span class="p">):</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="mi">101325</span>      <span class="c1"># reference pressure in pascals</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mf">0.02896968</span>   <span class="c1"># molar mass of air kg/mol</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>         <span class="c1"># gravity m/s^2</span>
    <span class="n">R0</span> <span class="o">=</span> <span class="mf">8.314462618</span> <span class="c1"># gas constant J/(mol·K) </span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">T0</span>           <span class="c1"># temp in kelvin</span>

    <span class="n">ratio</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">g</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R0</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">p_h</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p_h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">time</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<p>Okay, our first plot will be the variation
of the air pressure with respect to elevation.
To do this, we will first create our two arrays,
one for the elevations and then we feed that
into our nice function just like in the previous
notebook.</p>
<p>From there we can just use the <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>
function to make the plot. Pretty nifty!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressures</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0f54ff5cd0&gt;]
</pre></div>
</div>
<img alt="../../_images/ca1bf82aa56a11f5e308ebe24669a27ebbc2ed340fafc9bd58bc1dd07e4f7891.png" src="../../_images/ca1bf82aa56a11f5e308ebe24669a27ebbc2ed340fafc9bd58bc1dd07e4f7891.png" />
</div>
</div>
<p>Hmmm, something is going on with that x axis.
It only shows up to 400 but our heights array
goes to 20,000! What’s going on there? We only
gave the plot function the pressures, so it knows
nothing about the heights. By default matplotlib
will just label the x axis with 0 to N where N
is the length of the array you passed in to the
plot function.</p>
<p>To get both, you can optionally pass in both
what you want on the x axis <em>and</em> what you
want on the y axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">pressures</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0f4cd5ec10&gt;]
</pre></div>
</div>
<img alt="../../_images/727f1c73ef6f451aef7c59f55fc22dfa6906e144f679fb79abc8448f89af5698.png" src="../../_images/727f1c73ef6f451aef7c59f55fc22dfa6906e144f679fb79abc8448f89af5698.png" />
</div>
</div>
<p>One problem though. If you gave this plot
to a colleague they would have no clue what it
is telling them. To help them out let’s add some
axis labels. This can be done with the <code class="docutils literal notranslate"><span class="pre">plt.xlabel</span></code>
and <code class="docutils literal notranslate"><span class="pre">plt.ylabel</span></code> functions. Matplotlib automatically
knows to put them on the current plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">pressures</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Height above sea level [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Air pressure [pa]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Air pressure [pa]&#39;)
</pre></div>
</div>
<img alt="../../_images/11272ab9a98e389b20450c10a63f4f14b8e5b62a7d59ed7e0b6bb0e2a5995879.png" src="../../_images/11272ab9a98e389b20450c10a63f4f14b8e5b62a7d59ed7e0b6bb0e2a5995879.png" />
</div>
</div>
<p>Beautiful! But, we’re not done yet. If you’ve looked
closely at the function for the air pressure you might
have noticed we added a new argument <code class="docutils literal notranslate"><span class="pre">T0</span></code> with a default
argument of 273.15. By a default argument we mean that
if you don’t supply an alternative, it sets that one as
the value. But we know air pressure is a function of
temperature and so we might want to see how that affects
things. Let’s try a few and plot them.</p>
<p>To do that we just need to run a few new calculations,
and then call the <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> function on each of the
results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_273</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span>
<span class="n">p_293</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">293</span><span class="p">)</span>
<span class="n">p_313</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">313</span><span class="p">)</span>
<span class="n">p_333</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_273</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_293</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_333</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Height above sea level [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Air pressure [pa]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Air pressure [pa]&#39;)
</pre></div>
</div>
<img alt="../../_images/d28571267b88ed7a71a659ad0561e80df62c551d12d9557469a710693f3dcec1.png" src="../../_images/d28571267b88ed7a71a659ad0561e80df62c551d12d9557469a710693f3dcec1.png" />
</div>
</div>
<p>This is awesome, but we’re back to the fact that
if you handed this to someone else they would not have
a way of knowing what the different lines are for.
We can remedy this by adding <code class="docutils literal notranslate"><span class="pre">label</span></code>s to each of the calls
to <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>. Once those have been added we just call
<code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> after we are done plotting the lines to
add it to the figure</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_273</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span>
<span class="n">p_293</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">293</span><span class="p">)</span>
<span class="n">p_313</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">313</span><span class="p">)</span>
<span class="n">p_333</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_273</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=273K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_293</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=293K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_313</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=313K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_333</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=333K&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Height above sea level [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Air pressure [pa]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f0f54e6e7d0&gt;
</pre></div>
</div>
<img alt="../../_images/9c282920af79477461ed9a05f5fde8934381114c974e511977ef44648550392f.png" src="../../_images/9c282920af79477461ed9a05f5fde8934381114c974e511977ef44648550392f.png" />
</div>
</div>
<p>A final step on this particular plot. You can use
all of this functionality in loops so that your code
is a bit shorter and easier to modify. Let’s look at
how</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">273</span><span class="p">,</span> <span class="mi">293</span><span class="p">,</span> <span class="mi">313</span><span class="p">,</span> <span class="mi">333</span><span class="p">]</span>
<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="n">p_temp</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">p_temp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Height above sea level [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Air pressure [pa]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f0f54ef6390&gt;
</pre></div>
</div>
<img alt="../../_images/9c282920af79477461ed9a05f5fde8934381114c974e511977ef44648550392f.png" src="../../_images/9c282920af79477461ed9a05f5fde8934381114c974e511977ef44648550392f.png" />
</div>
</div>
<p>Okay, line plots are cool, but what else can
matplotlib do? Let’s look at images. So for this
one we’ll first run the air pressure function over
many different temperatures.</p>
<p>We then <code class="docutils literal notranslate"><span class="pre">stack</span></code> the results of our loop, which just
makes the whole thing a numpy array rather than a
list of numpy arrays. This is so matplotlib can
interpret what we want.</p>
<p>QUIZ: What’s the resulting dimension of <code class="docutils literal notranslate"><span class="pre">pressures</span></code>
after calling np.stack ?</p>
<p>Finally we call  <code class="docutils literal notranslate"><span class="pre">plt.colorbar</span></code> just so we know what
the values for the different colors are.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="n">p_new</span> <span class="o">=</span> <span class="n">air_pressure_at_height</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
    <span class="n">pressures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_new</span><span class="p">)</span>

<span class="c1"># Stack just sticks a list of numpy arrays </span>
<span class="c1"># together along a new dimension</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">pressures</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pressures</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>  <span class="c1"># Just shrinking the size of it</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pressure [pa]&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7f0f4cb71210&gt;
</pre></div>
</div>
<img alt="../../_images/94b0151b8ee45230e69ed4fab10920a80fe95c55c7c8efc2104de764bb650fb5.png" src="../../_images/94b0151b8ee45230e69ed4fab10920a80fe95c55c7c8efc2104de764bb650fb5.png" />
</div>
</div>
<p>Hmmm, now we’re back to the problem where
we don’t know what the x and y axes represent.
To fix this we’ll need to get into a slightly more
complex way of plotting. This mode requires more code
but is better for flexibility. For exploratory analysis
you can usually get away with just calling <code class="docutils literal notranslate"><span class="pre">plt.WHATEVER</span></code>
but this way of explicitly creating the <code class="docutils literal notranslate"><span class="pre">plt.figure</span></code> is
usually better for detailed plotting.</p>
<p>This one is a little bit complicated so it’s okay if
it doesn’t click right now, but I wanted to show it
because it is something common to need to make, but
a bit difficult, so I wanted to provide a reference.
This took me ~10 mins to re-figure out even though
I have been using matplotlib since ~2012.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">img</span><span class="p">,</span> 
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pressure [pa]&#39;</span>
<span class="p">)</span>

<span class="c1"># Ticks are where the labels are</span>
<span class="c1"># and ticklabels are what the labels are</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">heights</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">heights</span><span class="p">[</span><span class="n">xticks</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Elevation [m]&#39;</span><span class="p">)</span>

<span class="c1"># We do this for both the x and y dims</span>
<span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">temps</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">temps</span><span class="p">[</span><span class="n">yticks</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">)</span>
<span class="c1"># %%</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Temperature [K]&#39;)
</pre></div>
</div>
<img alt="../../_images/7a80022786dd5a9c9149ada0b87aa56f7ac9b5f004d17c31efc7221e07b7146a.png" src="../../_images/7a80022786dd5a9c9149ada0b87aa56f7ac9b5f004d17c31efc7221e07b7146a.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./course_content/module_2_numpy_and_matplotlib"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="1_intro_to_numpy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to numpy</p>
      </div>
    </a>
    <a class="right-next"
       href="../module_3_pandas_and_data_handling/1_intro_to_pandas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrew Bennett
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>