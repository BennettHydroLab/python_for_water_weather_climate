
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction to pandas &#8212; Python for water, weather, and climate science</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Some lessons on working with real world data: APIs and data wrangling" href="2_apis_for_data_handling.html" />
    <link rel="prev" title="Getting started with matplotlib" href="../module_2_numpy_and_matplotlib/2_intro_to_matplotlib.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Python for water, weather, and climate science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Python for research in Water, Weather, and Climate
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../module_1_intro_to_python/1_python_introduction.html">
   Welcome to Python for Water, Weather, and Climate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../module_2_numpy_and_matplotlib/1_intro_to_numpy.html">
   Introduction to numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../module_2_numpy_and_matplotlib/2_intro_to_matplotlib.html">
   Getting started with
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introduction to
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_apis_for_data_handling.html">
   Some lessons on working with real world data: APIs and data wrangling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../module_4_modeling_with_scikit_learn/1_intro_to_sklearn.html">
   Introduction to the
   <code class="docutils literal notranslate">
    <span class="pre">
     scikit-learn
    </span>
   </code>
   API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../module_5_geopandas_for_gis/1_intro_to_geopandas.html">
   Introduction to GIS in python with
   <code class="docutils literal notranslate">
    <span class="pre">
     geopandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../module_6_xarray_and_big_data/1_intro_to_xarray.html">
   Intro to
   <code class="docutils literal notranslate">
    <span class="pre">
     xarray
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/course_content/module_3_pandas_and_data_handling/1_intro_to_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/course_content/module_3_pandas_and_data_handling/1_intro_to_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Introduction to pandas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-pandas">
<h1>Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#introduction-to-pandas" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<p>Here we’ll open up some data from my GitHub account
It is snow data from Yosemite National Park for 2 locations
I am adding in some extra pieces of code to do some cleanup</p>
<ul class="simple">
<li><p>index_col=0 sets the “index” to the first column in the csv</p></li>
<li><p>skipinitialspace=True makes it so ” column_name” -&gt; “column_name”</p></li>
<li><p>parse_dates=True converts strings like “yyyy-mm-dd” to proper dates</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df = pd.read_csv(
    &#39;https://raw.githubusercontent.com/arbennett/&#39;
    &#39;summa_snow_layering_analysis/master/obs_data/dana_obs.csv&#39;,
    index_col=0, skipinitialspace=True, parse_dates=True
)
</pre></div>
</div>
</div>
</div>
<p>You can look at the first few values of data with <code class="docutils literal notranslate"><span class="pre">.head()</span></code>
Note here I did a <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> first to drop the values with no
data. This only drops them before printing out the head of the
data and missing data will stay recorded in the dataframe
If you wanted to drop them for good you would do <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">df.dropna()</span></code>
But that makes some of the plots look a little funky so I’m going
to leave them in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.dropna().head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tuolumne Meadows Pillow SWE [mm]</th>
      <th>Dana Meadows Pillow SWE [mm]</th>
    </tr>
    <tr>
      <th>Date [yyyy-mm-dd]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-11-10</th>
      <td>0.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1980-11-11</th>
      <td>13.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1980-11-12</th>
      <td>25.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1980-11-13</th>
      <td>25.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>1980-11-14</th>
      <td>25.0</td>
      <td>66.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Now we can start plotting easily!
df[&#39;Tuolumne Meadows Pillow SWE [mm]&#39;].plot()
df[&#39;Dana Meadows Pillow SWE [mm]&#39;].plot()
plt.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc14c1e45d0&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_6_1.png" src="../../_images/1_intro_to_pandas_6_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Alternatively, this plots all of the columns
df.plot()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_7_1.png" src="../../_images/1_intro_to_pandas_7_1.png" />
</div>
</div>
<p>There are many ways you can plot things - here’s
scatter plot. Note we need to say which columns to
put on the x and y axis. From this plot we can see
That Dana Meadows tends to get more snow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.plot.scatter(
    x=&#39;Tuolumne Meadows Pillow SWE [mm]&#39;,
    y=&#39;Dana Meadows Pillow SWE [mm]&#39;
)
# Plot a one-to-one line
plt.plot([0, 1500], [0, 1500], color=&#39;black&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fc141f571d0&gt;]
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_9_1.png" src="../../_images/1_intro_to_pandas_9_1.png" />
</div>
</div>
<p>One of pandas main strengths is how easy it makes
data analysis and encourages you to explore your
data in different ways. So here, we might try to
filter down some of the values and only look at the
yearly maximum data. To do this we will use a “groupby”
operation. The pandas documentation has a bunch of
examples if you scroll down:
<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html</a>
Anyways, here we will just look at the head again, this
is always a good practice - now you’ll see the index
is just yearly data rather than daily</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>yearly_max = df.groupby(df.index.year).max()
yearly_max.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tuolumne Meadows Pillow SWE [mm]</th>
      <th>Dana Meadows Pillow SWE [mm]</th>
    </tr>
    <tr>
      <th>Date [yyyy-mm-dd]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1979</th>
      <td>201.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>965.0</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>1981</th>
      <td>594.0</td>
      <td>635.0</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>1067.0</td>
      <td>1118.0</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>1346.0</td>
      <td>1763.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Now we can plot this too
yearly_max.plot()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_12_1.png" src="../../_images/1_intro_to_pandas_12_1.png" />
</div>
</div>
<p>But maybe it would look better as a bar plot?
To do that we do <code class="docutils literal notranslate"><span class="pre">.plot.bar()</span></code> rather than <code class="docutils literal notranslate"><span class="pre">.plot()</span></code>
Alternatively, you <em>can</em> do <code class="docutils literal notranslate"><span class="pre">.plot.line()</span></code> to get the
original plot, line plots are the default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>yearly_max.plot.bar()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_14_1.png" src="../../_images/1_intro_to_pandas_14_1.png" />
</div>
</div>
<p>Looking at the annual max is cool, but but what if we
want to know what the “average year” looks like?
To do that we can group by the “dayofyear”. This
basically groups all of the January 1s together
and all of the January 2s together, and so on.
Then with each of these grouped we take the <code class="docutils literal notranslate"><span class="pre">mean</span></code>
We then plot this. I have added two vertical line
markers, one for Sept22 (which is today as of me
writing this) and one for April 1st, which is
generally when the peak of the snow season is for
Yosemite.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>doy_mean = df.groupby(df.index.dayofyear).mean()
doy_mean.plot()
plt.axvline(265, label=&#39;September 22&#39;, color=&#39;dimgrey&#39;)
plt.axvline(91, label=&#39;April 1&#39;, color=&#39;black&#39;, linestyle=&#39;--&#39;)
plt.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc141fcf0d0&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_16_1.png" src="../../_images/1_intro_to_pandas_16_1.png" />
</div>
</div>
<p>Next up, just to show how this type of plot can be
used to summarize variability as well, we will take the
median, 25th percentile (or quantile, as pandas uses it
but really it’s the same thing), and 75th percentile.
And now we can plot thos for Dana meadows to show the
variability through the snow season</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>doy_med = df.groupby(df.index.dayofyear).median()
doy_low = df.groupby(df.index.dayofyear).quantile(0.25)
doy_high = df.groupby(df.index.dayofyear).quantile(0.75)

doy_med[&#39;Dana Meadows Pillow SWE [mm]&#39;].plot(color=&#39;black&#39;, label=&#39;median&#39;)
doy_low[&#39;Dana Meadows Pillow SWE [mm]&#39;].plot(color=&#39;red&#39;, label=&#39;25th percentile&#39;)
doy_high[&#39;Dana Meadows Pillow SWE [mm]&#39;].plot(color=&#39;blue&#39;, label=&#39;75th percentile&#39;)
plt.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc141d196d0&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_18_1.png" src="../../_images/1_intro_to_pandas_18_1.png" />
</div>
</div>
<p>Finally, this one is a bit more complex but it’s a common
operation to do, so I’m putting it here for your reference.
In the previous day of year plots we’ve done some aggregation
across all of the years, but what if we just wanted to plot
each year “on top” of each other. This is known as a
“spaghetti plot”: <a class="reference external" href="https://www.data-to-viz.com/caveat/spaghetti.html">https://www.data-to-viz.com/caveat/spaghetti.html</a>
To do this, we actually need to create a new table where the columns
are each year, and the index is the day of the year. This can
be done with a pivot table, which is the same concept as with
spreadsheets if you are familiar: <a class="reference external" href="https://en.wikipedia.org/wiki/Pivot_table">https://en.wikipedia.org/wiki/Pivot_table</a>
Anyhow, we set it up like this:</p>
<ul class="simple">
<li><p>df: the data frame we’ve been working with</p></li>
<li><p>index=df.index.dayofyear: The new index that will be produced</p></li>
<li><p>columns=df.index.year: The new columns that will be produced</p></li>
<li><p>values=’Tuolumne…’: The column to use from the original <code class="docutils literal notranslate"><span class="pre">df</span></code></p></li>
<li><p>aggfunc=’mean’: take the mean value</p></li>
</ul>
<p>As is customary let’s look at the head afterwards to see what we’ve got.
You can see it’s got columns which are the years, and an index which
just counts up. These are the “dayofyears” where 1 means January1,
2 means January2, 91 means April1, and 265 means Sept22.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pt = pd.pivot_table(
    df, 
    index=df.index.dayofyear, 
    columns=df.index.year,
    values=&#39;Tuolumne Meadows Pillow SWE [mm]&#39;, 
    aggfunc=&#39;mean&#39;
)
pt.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Date [yyyy-mm-dd]</th>
      <th>1979</th>
      <th>1980</th>
      <th>1981</th>
      <th>1982</th>
      <th>1983</th>
      <th>1984</th>
      <th>1985</th>
      <th>1986</th>
      <th>1987</th>
      <th>1988</th>
      <th>...</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
    </tr>
    <tr>
      <th>Date [yyyy-mm-dd]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>76.0</td>
      <td>356.0</td>
      <td>549.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>257.0</td>
      <td>0.0</td>
      <td>183.0</td>
      <td>...</td>
      <td>356.0</td>
      <td>82.0</td>
      <td>109.0</td>
      <td>129.0</td>
      <td>162.0</td>
      <td>408.0</td>
      <td>49.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>74.0</td>
      <td>371.0</td>
      <td>549.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>259.0</td>
      <td>3.0</td>
      <td>183.0</td>
      <td>...</td>
      <td>381.0</td>
      <td>82.0</td>
      <td>109.0</td>
      <td>132.0</td>
      <td>162.0</td>
      <td>420.0</td>
      <td>55.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>74.0</td>
      <td>381.0</td>
      <td>546.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>262.0</td>
      <td>3.0</td>
      <td>185.0</td>
      <td>...</td>
      <td>457.0</td>
      <td>85.0</td>
      <td>109.0</td>
      <td>135.0</td>
      <td>162.0</td>
      <td>426.0</td>
      <td>46.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>394.0</td>
      <td>549.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>264.0</td>
      <td>43.0</td>
      <td>223.0</td>
      <td>...</td>
      <td>457.0</td>
      <td>85.0</td>
      <td>115.0</td>
      <td>132.0</td>
      <td>162.0</td>
      <td>423.0</td>
      <td>31.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>533.0</td>
      <td>551.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>278.0</td>
      <td>49.0</td>
      <td>253.0</td>
      <td>...</td>
      <td>457.0</td>
      <td>115.0</td>
      <td>210.0</td>
      <td>135.0</td>
      <td>159.0</td>
      <td>405.0</td>
      <td>28.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
<p>And with that we can plot the spaghetti!
Note you probably want to do <code class="docutils literal notranslate"><span class="pre">legend=False</span></code> here so that
you don’t have a legend which has all 37 lines on it.
Similarly we make all the of the lines grey just so it’s
a bit less aggressive on the eyes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pt.plot(legend=False, color=&#39;grey&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1_intro_to_pandas_22_1.png" src="../../_images/1_intro_to_pandas_22_1.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./course_content/module_3_pandas_and_data_handling"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../module_2_numpy_and_matplotlib/2_intro_to_matplotlib.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Getting started with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2_apis_for_data_handling.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Some lessons on working with real world data: APIs and data wrangling</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Andrew Bennett<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>