

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Introduction to pandas &#8212; Python for water, weather, and climate science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'course_content/module_3_pandas_and_data_handling/1_intro_to_pandas';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Some lessons on working with real world data: APIs and data wrangling" href="2_apis_for_data_handling.html" />
    <link rel="prev" title="Getting started with matplotlib" href="../module_2_numpy_and_matplotlib/2_intro_to_matplotlib.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    <p class="title logo__title">Python for water, weather, and climate science</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Python for research in Water, Weather, and Climate
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 1 - Introduction to python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../module_1_intro_to_python/1_python_introduction.html">Introduction to python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_1_intro_to_python/2_python_stuff_you_should_know.html">Intermediate python - Or, stuff you should know</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_1_intro_to_python/exercises.html">Exercises for Module 1: Intro to Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 2 - Introduction to scientific python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../module_2_numpy_and_matplotlib/1_intro_to_numpy.html">Introduction to numpy</a></li>

<li class="toctree-l1"><a class="reference internal" href="../module_2_numpy_and_matplotlib/2_intro_to_matplotlib.html">Getting started with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 3 - Working with real data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="2_apis_for_data_handling.html">Some lessons on working with real world data: APIs and data wrangling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 6 - Working with real climate data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../module_6_xarray_and_big_data/1_intro_to_xarray.html">Intro to <code class="docutils literal notranslate"><span class="pre">xarray</span></code></a></li>

<li class="toctree-l1"><a class="reference internal" href="../module_6_xarray_and_big_data/xarray_exercises_pt2.html"><code class="docutils literal notranslate"><span class="pre">xarray</span></code> exercises pt 2: ENSO Analysis</a></li>





</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/course_content/module_3_pandas_and_data_handling/1_intro_to_pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-pandas">
<h1>Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#introduction-to-pandas" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<p>Here we’ll open up some data from my GitHub account
It is snow data from Yosemite National Park for 2 locations
I am adding in some extra pieces of code to do some cleanup</p>
<ul class="simple">
<li><p>index_col=0 sets the “index” to the first column in the csv</p></li>
<li><p>skipinitialspace=True makes it so ” column_name” -&gt; “column_name”</p></li>
<li><p>parse_dates=True converts strings like “yyyy-mm-dd” to proper dates</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s1">&#39;https://raw.githubusercontent.com/arbennett/&#39;</span>
    <span class="s1">&#39;summa_snow_layering_analysis/master/obs_data/dana_obs.csv&#39;</span><span class="p">,</span>
    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can look at the first few values of data with <code class="docutils literal notranslate"><span class="pre">.head()</span></code>
Note here I did a <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> first to drop the values with no
data. This only drops them before printing out the head of the
data and missing data will stay recorded in the dataframe
If you wanted to drop them for good you would do <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">df.dropna()</span></code>
But that makes some of the plots look a little funky so I’m going
to leave them in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tuolumne Meadows Pillow SWE [mm]</th>
      <th>Dana Meadows Pillow SWE [mm]</th>
    </tr>
    <tr>
      <th>Date [yyyy-mm-dd]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-11-10</th>
      <td>0.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1980-11-11</th>
      <td>13.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1980-11-12</th>
      <td>25.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1980-11-13</th>
      <td>25.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>1980-11-14</th>
      <td>25.0</td>
      <td>66.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we can start plotting easily!</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tuolumne Meadows Pillow SWE [mm]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dana Meadows Pillow SWE [mm]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc14c1e45d0&gt;
</pre></div>
</div>
<img alt="../../_images/82badfdb7cbca0bb69e2f0169c0186ea005dc8cd325f19a216e8e5334efe7067.png" src="../../_images/82badfdb7cbca0bb69e2f0169c0186ea005dc8cd325f19a216e8e5334efe7067.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Alternatively, this plots all of the columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/82badfdb7cbca0bb69e2f0169c0186ea005dc8cd325f19a216e8e5334efe7067.png" src="../../_images/82badfdb7cbca0bb69e2f0169c0186ea005dc8cd325f19a216e8e5334efe7067.png" />
</div>
</div>
<p>There are many ways you can plot things - here’s
scatter plot. Note we need to say which columns to
put on the x and y axis. From this plot we can see
That Dana Meadows tends to get more snow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Tuolumne Meadows Pillow SWE [mm]&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Dana Meadows Pillow SWE [mm]&#39;</span>
<span class="p">)</span>
<span class="c1"># Plot a one-to-one line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fc141f571d0&gt;]
</pre></div>
</div>
<img alt="../../_images/1c451d6ec8d54446711d1b3eb8594051f89d42acaad59ba30c10bad762602a28.png" src="../../_images/1c451d6ec8d54446711d1b3eb8594051f89d42acaad59ba30c10bad762602a28.png" />
</div>
</div>
<p>One of pandas main strengths is how easy it makes
data analysis and encourages you to explore your
data in different ways. So here, we might try to
filter down some of the values and only look at the
yearly maximum data. To do this we will use a “groupby”
operation. The pandas documentation has a bunch of
examples if you scroll down:
<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html</a>
Anyways, here we will just look at the head again, this
is always a good practice - now you’ll see the index
is just yearly data rather than daily</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yearly_max</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">yearly_max</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tuolumne Meadows Pillow SWE [mm]</th>
      <th>Dana Meadows Pillow SWE [mm]</th>
    </tr>
    <tr>
      <th>Date [yyyy-mm-dd]</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1979</th>
      <td>201.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>965.0</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>1981</th>
      <td>594.0</td>
      <td>635.0</td>
    </tr>
    <tr>
      <th>1982</th>
      <td>1067.0</td>
      <td>1118.0</td>
    </tr>
    <tr>
      <th>1983</th>
      <td>1346.0</td>
      <td>1763.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we can plot this too</span>
<span class="n">yearly_max</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/3660d933335500bd7f2f5059f8459bf0fc8dc3a9be680c2f6576c05ea1d4aa46.png" src="../../_images/3660d933335500bd7f2f5059f8459bf0fc8dc3a9be680c2f6576c05ea1d4aa46.png" />
</div>
</div>
<p>But maybe it would look better as a bar plot?
To do that we do <code class="docutils literal notranslate"><span class="pre">.plot.bar()</span></code> rather than <code class="docutils literal notranslate"><span class="pre">.plot()</span></code>
Alternatively, you <em>can</em> do <code class="docutils literal notranslate"><span class="pre">.plot.line()</span></code> to get the
original plot, line plots are the default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yearly_max</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/328d24c745590184926a1581b727ce7e604aa4af6e9298f245921eef4806cebf.png" src="../../_images/328d24c745590184926a1581b727ce7e604aa4af6e9298f245921eef4806cebf.png" />
</div>
</div>
<p>Looking at the annual max is cool, but but what if we
want to know what the “average year” looks like?
To do that we can group by the “dayofyear”. This
basically groups all of the January 1s together
and all of the January 2s together, and so on.
Then with each of these grouped we take the <code class="docutils literal notranslate"><span class="pre">mean</span></code>
We then plot this. I have added two vertical line
markers, one for Sept22 (which is today as of me
writing this) and one for April 1st, which is
generally when the peak of the snow season is for
Yosemite.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doy_mean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">doy_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">265</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;September 22&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dimgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">91</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;April 1&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc141fcf0d0&gt;
</pre></div>
</div>
<img alt="../../_images/ccc4bd16ceab1b005c4d51c1202b6a599a1c43596e42cca4a802bc3fc191b091.png" src="../../_images/ccc4bd16ceab1b005c4d51c1202b6a599a1c43596e42cca4a802bc3fc191b091.png" />
</div>
</div>
<p>Next up, just to show how this type of plot can be
used to summarize variability as well, we will take the
median, 25th percentile (or quantile, as pandas uses it
but really it’s the same thing), and 75th percentile.
And now we can plot thos for Dana meadows to show the
variability through the snow season</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doy_med</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">doy_low</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">doy_high</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>

<span class="n">doy_med</span><span class="p">[</span><span class="s1">&#39;Dana Meadows Pillow SWE [mm]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
<span class="n">doy_low</span><span class="p">[</span><span class="s1">&#39;Dana Meadows Pillow SWE [mm]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;25th percentile&#39;</span><span class="p">)</span>
<span class="n">doy_high</span><span class="p">[</span><span class="s1">&#39;Dana Meadows Pillow SWE [mm]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;75th percentile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc141d196d0&gt;
</pre></div>
</div>
<img alt="../../_images/a30bdcde4716cfd4ae23dea1d34f86ac6722777834a01242b866779cb6f55462.png" src="../../_images/a30bdcde4716cfd4ae23dea1d34f86ac6722777834a01242b866779cb6f55462.png" />
</div>
</div>
<p>Finally, this one is a bit more complex but it’s a common
operation to do, so I’m putting it here for your reference.
In the previous day of year plots we’ve done some aggregation
across all of the years, but what if we just wanted to plot
each year “on top” of each other. This is known as a
“spaghetti plot”: <a class="reference external" href="https://www.data-to-viz.com/caveat/spaghetti.html">https://www.data-to-viz.com/caveat/spaghetti.html</a>
To do this, we actually need to create a new table where the columns
are each year, and the index is the day of the year. This can
be done with a pivot table, which is the same concept as with
spreadsheets if you are familiar: <a class="reference external" href="https://en.wikipedia.org/wiki/Pivot_table">https://en.wikipedia.org/wiki/Pivot_table</a>
Anyhow, we set it up like this:</p>
<ul class="simple">
<li><p>df: the data frame we’ve been working with</p></li>
<li><p>index=df.index.dayofyear: The new index that will be produced</p></li>
<li><p>columns=df.index.year: The new columns that will be produced</p></li>
<li><p>values=’Tuolumne…’: The column to use from the original <code class="docutils literal notranslate"><span class="pre">df</span></code></p></li>
<li><p>aggfunc=’mean’: take the mean value</p></li>
</ul>
<p>As is customary let’s look at the head afterwards to see what we’ve got.
You can see it’s got columns which are the years, and an index which
just counts up. These are the “dayofyears” where 1 means January1,
2 means January2, 91 means April1, and 265 means Sept22.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">,</span> 
    <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Tuolumne Meadows Pillow SWE [mm]&#39;</span><span class="p">,</span> 
    <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span>
<span class="p">)</span>
<span class="n">pt</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Date [yyyy-mm-dd]</th>
      <th>1979</th>
      <th>1980</th>
      <th>1981</th>
      <th>1982</th>
      <th>1983</th>
      <th>1984</th>
      <th>1985</th>
      <th>1986</th>
      <th>1987</th>
      <th>1988</th>
      <th>...</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
    </tr>
    <tr>
      <th>Date [yyyy-mm-dd]</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>76.0</td>
      <td>356.0</td>
      <td>549.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>257.0</td>
      <td>0.0</td>
      <td>183.0</td>
      <td>...</td>
      <td>356.0</td>
      <td>82.0</td>
      <td>109.0</td>
      <td>129.0</td>
      <td>162.0</td>
      <td>408.0</td>
      <td>49.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>74.0</td>
      <td>371.0</td>
      <td>549.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>259.0</td>
      <td>3.0</td>
      <td>183.0</td>
      <td>...</td>
      <td>381.0</td>
      <td>82.0</td>
      <td>109.0</td>
      <td>132.0</td>
      <td>162.0</td>
      <td>420.0</td>
      <td>55.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>74.0</td>
      <td>381.0</td>
      <td>546.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>262.0</td>
      <td>3.0</td>
      <td>185.0</td>
      <td>...</td>
      <td>457.0</td>
      <td>85.0</td>
      <td>109.0</td>
      <td>135.0</td>
      <td>162.0</td>
      <td>426.0</td>
      <td>46.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>394.0</td>
      <td>549.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>264.0</td>
      <td>43.0</td>
      <td>223.0</td>
      <td>...</td>
      <td>457.0</td>
      <td>85.0</td>
      <td>115.0</td>
      <td>132.0</td>
      <td>162.0</td>
      <td>423.0</td>
      <td>31.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>533.0</td>
      <td>551.0</td>
      <td>521.0</td>
      <td>300.0</td>
      <td>278.0</td>
      <td>49.0</td>
      <td>253.0</td>
      <td>...</td>
      <td>457.0</td>
      <td>115.0</td>
      <td>210.0</td>
      <td>135.0</td>
      <td>159.0</td>
      <td>405.0</td>
      <td>28.0</td>
      <td>278.0</td>
      <td>NaN</td>
      <td>43.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
<p>And with that we can plot the spaghetti!
Note you probably want to do <code class="docutils literal notranslate"><span class="pre">legend=False</span></code> here so that
you don’t have a legend which has all 37 lines on it.
Similarly we make all the of the lines grey just so it’s
a bit less aggressive on the eyes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Date [yyyy-mm-dd]&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/1a8008e98ada08f61afb158b727aab1eb9b1ea917371c8aac8d42ce42403a926.png" src="../../_images/1a8008e98ada08f61afb158b727aab1eb9b1ea917371c8aac8d42ce42403a926.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./course_content/module_3_pandas_and_data_handling"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../module_2_numpy_and_matplotlib/2_intro_to_matplotlib.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Getting started with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="2_apis_for_data_handling.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Some lessons on working with real world data: APIs and data wrangling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrew Bennett
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>